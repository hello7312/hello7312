<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Vocabulary Quiz</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    button { margin: 5px; padding: 10px; }
    .quiz-block { margin-top: 20px; }
    input { padding: 5px; font-size: 16px; }
  </style>
</head>
<body>
  <h1>Vocabulary Quiz</h1>
  <div id="nav"></div>
  <div class="quiz-block">
    <h3 id="question"></h3>
    <input id="answer" placeholder="Type your answer" />
    <button onclick="checkAnswer()">Check</button>
    <p id="feedback"></p>
  </div>

  <script>
    const lists = ["A1", "A2", "B1", "B2", "B3"];
    let currentList = "A1";
    let words = [];
    let current = 0;

    function speak(text) {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'en-US';
      speechSynthesis.speak(utterance);
    }

    function loadList(name) {
      currentList = name;
      fetch(name + ".json")
        .then(res => res.json())
        .then(data => {
          words = data;
          current = 0;
          showQuestion();
        });
    }

    function showQuestion() {
      const word = words[current];
      const mode = Math.floor(Math.random() * 3);
      document.getElementById("answer").value = "";
      document.getElementById("feedback").textContent = "";

      if (mode === 0) {
        document.getElementById("question").textContent = `中翻英：${word.zh}`;
        document.getElementById("question").dataset.answer = word.en.toLowerCase();
      } else if (mode === 1) {
        document.getElementById("question").textContent = `英翻中：${word.en}`;
        document.getElementById("question").dataset.answer = word.zh;
      } else {
        document.getElementById("question").textContent = `聽音寫單字：🔊`;
        speak(word.en);
        document.getElementById("question").dataset.answer = word.en.toLowerCase();
      }
    }

    function checkAnswer() {
      const userAns = document.getElementById("answer").value.trim().toLowerCase();
      const correctAns = document.getElementById("question").dataset.answer;
      if (userAns === correctAns) {
        document.getElementById("feedback").textContent = "✅ 正確！";
      } else {
        document.getElementById("feedback").textContent = `❌ 錯誤，正確答案是：${correctAns}`;
      }
      current = (current + 1) % words.length;
      setTimeout(showQuestion, 1500);
    }

    // 建立按鈕
    document.getElementById("nav").innerHTML = lists.map(list =>
      `<button onclick="loadList('${list}')">${list}</button>`
    ).join("");

    loadList("A1");
  </script>
</body>
</html>